<!DOCTYPE html>
<meta charset="utf-8">
<html>
 <head>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="d3sparql.js"></script>
  <script>
  function exec() {
    /* Uncomment to see debug information in console */
    d3sparql.debug = true
    var endpoint = d3.select("#endpoint").property("value")
    var sparql = d3.select("#sparql").property("value")
    d3sparql.query(endpoint, sparql, render)
  }
  function render(json) {
    /* set options and call the d3spraql.xxxxx function in this library ... */
    config = {
      "width":    1000,      // canvas width (optional)
      "height":   900,       // canvas height (optional)
      "margin":   150,       // margin for labels (optional)
      "selector": "#result"
      // options for d3sparql.tree() can be added here ...
    }
    d3sparql.sunburst(json, config)
  }
  </script>
  <style>
      <style>
    .node text {
      font-size: 10px;
      font-family: sans-serif;
    }
    .arc {
      stroke: #ffffff;
      fill-rule: evenodd;
    }
    </style>
  </style>
 </head>
 <body onload="exec()">
    <form style="display:none">
   <input id="endpoint" value="http://dbpedia.org/sparql" type="text">
   <textarea id="sparql">
    PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
SELECT ?root_name ?child_name ?parent_name1 ?parent_name2
WHERE { VALUES ?root_name {'ERA'}
?child <http://fedora.info/definitions/v4/repository#hasParent> <http://gillingham.library.ualberta.ca:8080/fedora/rest/prod> .
?child <http://terms.library.ualberta.ca/identifiers/is_community> "true"^^xsd:boolean .
?child <http://purl.org/dc/terms/title> ?child_name .
?child <info:fedora/fedora-system:def/relations-external#hasCollectionMember> ?parentID1 .
?parent1 <http://terms.library.ualberta.ca/identifiers/hasCollectionId> ?parentID1 .
?parent1 <http://purl.org/dc/terms/title> ?parent_name1 .
?parent2 <http://terms.library.ualberta.ca/identifiers/hasCollectionId> ?parentID1 .
?parent2 <http://purl.org/dc/terms/title> ?parent_name2
}
   </textarea>
  </form>
  <div id="result"></div>
 </body>
</html>
